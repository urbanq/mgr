\chapter{Podsumowanie i wnioski}
\label{cha:podsumowanie}

Celem niniejszej pracy było stworzenie aplikacji gruper zgodnie ze specyfikacją NFZ. Aplikacja miała zostać zaprojektowana tak, aby spełniała założenia systemu ekspertowego. Następnie miała zostać rozszerzona tak, aby wspomóc proces optymalizacji kosztów leczenia pacjetna poprzez mechanizm podpowiadający lekarzowi rozwiązania lepsze dla stawianego problemu. Zadanie jest trudne, gdyż wymaga zdobycia i zrozumienia wiedzy z zakresu medycznegeo. Interpretacja dokumentacji wydanej przez NFZ takiej jak wskazówki do napisania aplikacji typu gruper było zadaniem nietrywialnym. Dostosowanie systemu tak, aby był on systemem ekspertowym wymagało również odpowiedniego podejścia, ponieważ powinien on działać nie zmieniając zasad zdefiniowanych przez NFZ.

System, który stworzyłem jest zgodny z wszystkimi stawianymi na początku założeniami projektowymi. Jest on zalążkiem systemu ekspertowego, ponieważ inżynier może definiować reguły tylko w wydzielonym obszarze. W sekcji~\ref{sec:mozliwoscRozwoju} opisana została wizja możliwosci rozwoju systemu.

%---------------------------------------------------------------------------

\section{Możliwość rozwoju}
\label{sec:mozliwoscRozwoju}

Ze wględu na fakt, że aplikacja została napisana w modelu architektury 3-warstowej, bardzo dobrym rozwinięciem istniejącego rozwiązania byłoby: uruchomienie części odpowiadającej za logikę biznesową i za dostęp do danych na serwerze aplikacyjnym. Warstwę prezentacji można zaimplementować jako aplikację webową. Tak, żeby stworzyć system on-line z gruperem.

Duże możliwości rozwoju projektu sprawia fakt, że jest to jedyne rozwiązanie typu openSource na rynku. Tego typu otwarte projekty przyciągają zainteresowanie jednostek dla których jest dedykowane rozwiązanie. Programiści, projektanci aplikacji z branży medycznej mogliby mieć duży wpływ na dalszy rozwój aplikacji. Specjaliści mogliby zgłaszać błędy, tworząc bug-report, oraz proponować własne funkcjonalności, zgłaszając je w systemie z zadaniami. Mogliby oni używać części serwerowej systemu w jednym z modułów swoich złożonych aplikacji do obsługi szpitala. Wtedy nie spada odpowiedzialność na każdą z osobna aplikację w Polsce do obsługi przychodni bądź szpitala tworzenie własnej implementacji grupera. Warto zaznaczyć w ty miejscu, że jeśli lekarz nie posiada dedykowanej aplikacji grupera to jego obowiązkiem jest manualne wyznaczanie grup JGP na podstawie arkusza Excel publikowanego przez NFZ. 
Zakładając, że istniałby w Polsce taki jeden pewny moduł do obsługi rozliczeń kosztów leczenia pacjenta, mógłby on być używany przez wszystkie istniejące aplikacje. Rozwiązania komercyjne musiałyby jedynie podpiąć się do modułu przez zewnętrzne serwisy. Projektanci, architekci i developerzy mieliby dostęp do pełnej dokumentacji tego modułu i mogliby go w pełni wykorzystywać, nie tracąc cennego czasu na implmentację od zera.

Ważnym kierunkiem rozwoju aplikacji jest rozwój w kierunku systemu ekspertowego. Standaryzacja wiedzy, łatwość modyfikowania faktów i reguł systemu sprawiają, że jest on potężnym narzędziem w rękach ekspertów. Częste wprowadzanie zmian w regułach grupowania sprawia, że w standardowym podejściu - programiści muszą wprowadzać zmiany do kodu algorytmu. W podejściu ekspertowym zmiany te mogliby wprowadzać bezpośrednio inżynierowie wiedzy, bez potrzeby ingerencji w kod systemu. Pracownicy NFZ produkujący dokumentację w formie MS-Word(algorytm i reguły) i w MS-Excel bazę wiedzy, mogliby po zapoznaniu się z systemem używać go. Wprowadzaliby oni dane do systemu jako inżynierowie wiedzy. Dodawaliby nowe fakty takie jak procedury, rozpoznania, kody jgp. Edytowaliby reguły, zmieniając warunki akceptacji grupy JGP, modyfikując obiekty klasy JGPParameters oraz powiązane z nimi obiekty klasy Agelimit - HospitalLimit. Wszystkie warunki dla reguł mogliby edytować z poziomu dostępu ,,experta'' do systemu.
W takim podejściu wyróżniłbym na początku 2 role: EXPERT i USER. EXPERT miałby dostęp do edycji faktow i reguł. USER do uruchomienia wnioskowania.

Nasuwają się też pomysły na ulepszenie jądra systemu ekspertowego, którym jest mechanizm wnioskowania. Aktualne rozwiązanie zapisuje warunki kierunkowe w bazie jako literki alfabetu. Krokiem w kierunku zapisywania reguł w systemie byłoby zapisywanie skryptów języka Groovy w bazie wiedzy, oraz udostępnienie ich do edycji dla użytkowników z rolą eskperta. Każdy z tych skryptów byłby pobierany i odpalany przez silnik w odpowiednim momencie.
Dalszym rozwinięciem byłoby umieszczenie kolejnych skryptów Groovy w bazie wiedzy, które byłyby odpalane przez silnik wnioskowania. Skryptem zapisanym w języku Groovy mogłaby być część kodu wybierająca odpowiednią ścieżkę poszukiwania(ICD9 lub ICD10) lub kod wyliczający wartości dla mechanizmu osobodni. Takie podejście tworzy uniwersalny system regułowy, którego algorytm mógłby być edytowany bez ingerencji w kod javy. Inżynierowie wiedzy, jeśli nie pracownicy NFZ, to lekarze zainteresowani systemem wprowadzaliby poprawki w kluczowych dla algorytmu wycinkach kodu zapisanych w Groovy'm, ktory jest językiem bardzo czytelnym, przejrzystym, łatwym do nauczenia i zrozumienia dla każdego. W ten sposób otrzymalibyśmy spójny system ekspertowy usprawniający wszystkie aplikacje medyczne w Polsce z bazą wiedzy kontrolowaną przez NFZ, którego zadaniem byłoby wprowadzanie na bieżąco poprawek do algorytmu. Każda zewnętrzna aplikacja mogłaby podpiąc się do dedykowanych serwerów i używać grupowania zgodnego z zasadami NFZ.

Kolejnym pomysłem na rozwinięcie aplikacji jest używanie programowania aspektowego. Dla metod sprawdzających warunki można zrealizować zapisywanie powodów niezaakceptowania automatycznie poprzez aspekty, nie ręcznie jak dotychczas. Dla każdego sprawdzanego warunku byłaby zapisywana pełna lista powodów zaakceptowania lub niezaakceptowania. Takie rozwiązanie dałoby całościowy obraz scieżki wyszukiwania dla wszystkich sprawdzanych rozwiązań.

Wydanych zostało ponad 10 wersji algorymtu grupera, ale przedmiotem tej pracy nie było wyszukiwanie drobnych różnic między nimi. Można rozwinąć system wprowadzając wersjonowanie algorytmów i tworząc wszystkie instancje algorytmu, które uruchamiane byłyby w zależności od daty hospitalizacji, dla której algorytm jest aktualny.

%---------------------------------------------------------------------------

\section{Porównanie z innymi istniejącymi rozwiązaniami}
\label{sec:porownanieZinnymiRozwiazaniami}

Przeanalizowałem konkurencyjne rozwiązania na rynku. Najpopularniejsze aplikacje, postanowiłem zainstalować, uruchomić i porównać z moim rozwiązaniem. A oto listing systemów medycznych zawierających algorytm grupera:

\textbf{MP-System} - złożony system do kompleksowej obsługi szpitali. Już w trakcie instalacji wersji demo pojawiły się błędy dotyczące starej wersji serwera MS-SQL(dostarczanej wraz z aplikacją). Niestety nawet po kilku-godzinnych trudach nie udało mi się zainstalować i uruchomić aplikacji. Skomplikowany proces instalacji przez, który ciężko przebrnąć skutecznie odstrasza przeciętnych użytkowników aplikacji jakimi są lekarze.

\textbf{Internetowy OPTYMALIZATOR JGP} CompuGroup Medical Polska Lublin - wersja demo dostępna pod adresem http://jgp.uhc.com.pl/jgpgrouper.
Rozwiązanie z punktu widzenia użytkownika końcowego podobne do mojego. Aplikacja posiada 5 darmowych grupowań na dzień, powyżej tej liczby jest płatne. Według statystyk zamieszonych na stronie przy użyciu aplikacji przeporwadzono 4mln grupowań dla kilkuset szpitali. Jest to rozwiązanie wysokiej jakości, ale płatne.
System ten posiada również moduł do optymalizacji, z którego korzysta 58\% użytkowników(pozostałe 42\% korzysta z samego algorytmu grupowania).

\textbf{SMARTGRUPER} - http://smartgruper.pl - jest to rozwiązanie płatne, nie posiadające wersji demo. Z opisu na stronie projektu wynika, że jest to wysokiej jakości oprogramowanie, które udostępnia wiele funkcjonalności poza standardowym gruperem. Aplikacja udostępnia moduł optymalizacji JGP, zapisywanie grupowań itp. funkcjonalności. Dostępne są 3 wersje produktu:
\begin{itemize}
 \item Wersja On-line. Dostęp indywidualny oraz dla małych placówek medycznych. Dostęp do systemu Smart Gruper on-line.
 \item Wersja Professional. Rozwiązanie dla szpitala bez integracji. Instalacja na serwerze w szpitalu.
 \item Wersja Enterprise. Rozwiązanie dla szpitala z integracją. Instalacja na serwerze w szpitalu oraz integracja z istniejącym systemem informatycznym szpitala.
\end{itemize}

Każdy z powyżej wymienionych systemów jest rozwiązaniem komercyjnym. System stworzony w ramach tej pracy jest aktualnie jedynym rozwiązaniem typu openSource na rynku oraz jedynym rozwiązaniem, które wnosi możliwości jakie daje profesjonalny system ekspertowy.

Co dalej?
Przyszłością jest powstający system Euro-DRG 7, który docelowo stanowiłby jednolity system JGP dla całej Unii Europejskiej(http://www.eurodrg.eu).
NFZ stał się partnerem systemu Euro-DRG i aktywnie uczestniczy w jego tworzeniu. Być może stworzenie platformy systemu ekspertowego dla systemu Euro-DRG byłoby dobrym kierunkiem rozwoju tego typu rozwiązania. Jako projekt ,,open source'' posiadałby on swoich aktywnych uczestników nie tylko w Polsce, ale w całej Unii Europejskiej. Niestety nie określona została jeszcze specyfikacja systemu. Problematyczne jest podejście wszystkich firm startujących w przetargach, ponieważ każda z nich chce mieć monopol na cały obszar zastosowania systemu. Jest to w mojej opinii poważna przeszkoda w tworzeniu najlepszej jakości oprogramowania, ponieważ w jej wyniku powstają systemy skomplikowane, ktorych używa się tylko dlatego, że nie ma innej alternatywy. Podobnie jak system operacyjny Linux jest ciągle ,,konkurencją'' dla systemu Winodws, tak samo oprogramowanie openSource w każdej dziedzinie będzie uczestniczyć w nieustającym wyścigu z oprogramowaniem komercyjnym. 

%---------------------------------------------------------------------------

\section{Wykorzystane biblioteki}
\label{sec:wykorzystaneBiblioteki}
Oto listing narzędzi wykorzystanych do stworzenia systemu open-grupera:
\begin{table}[h]
 \caption{Wykorzystane narzędzia}
 \small\tt
 \centering
 \vspace{0in}
 \begin{tabular}{|l|p{7cm}|}
 \hline
 GIT & repozytorium kod źródłowy (https://github.com/urbanq/mgr) \\
 \hline
 commons-collections-3.2.1 & Pomocnicze metody dla operacji na kolekcjach \\
 \hline
 aspectj-1.6.10 & Aspekty dla JAVY \\
 \hline
 h2database-1.3.166 & Silnik bazodanowy H2 \\
 \hline
 junit-4.10 & Środowisko testowe \\
 \hline
 jgoodies-2.2.0 & GUI narzędzia pomocnicze \\
 \hline
 jodatime-2.1 & Najlepsza biblioteka do wykonywania obliczeń datowo/czasowych \\
 \hline
 spring-framework-3.0.5 & Spring framework z komponentami Core, JDBC, Security, Beans, Aspects, ORM, Test, TX \\
 \hline
 valkyriercp-1.0 & Biblioteka pozwalająca na wysokopozimowe programowanie GUI \\
 \hline
 \end{tabular}
\end{table}

%---------------------------------------------------------------------------

\section{Jakość oprogramowania}
\label{sec:jakoscOprogramowania}

Zestawienie wartości liczbowych charakteryzujące oprogramowanie jest nazywane metryką oprogramowania. Dla projektu wykonanego w ramach pracy obliczyłem następujące wartości metryk chrakteryzujące jego wielkość:
\begin{itemize}
 \item 7009 LOC(Lines of code) - ilość linijek kodu źródłowego
 \item 191 C(Classes) - ilość zdefiniowanych klas JAVY.
\end{itemize}

Następne zestawienie metryk charakteryzujące jakość napisanego kodu to MOOD - Metrics for Object-Oriented Design. Metryki te służą do wyrażenia w procentach cech charakteryzujących dla programowania obiektowego:
\begin{itemize}
 \item 78,26\% AHF - Attribute Hiding Factor - hermetyzacja atrybutów
 \item 23,55\% MHF - Method Hiding Factor - hermetyzacja metod
 \item 71,49\% AIF - Attribute Inheritance Factor - dziedziczenie atrybutów
 \item 32,29\% MIF - Method Inheritance Factor - dziedziczenie metod
 \item 5,47\% CF - Coupling Factor - przekazywanie komunikatów 
 \item 57,21\% PF - polimorfizm
\end{itemize}

